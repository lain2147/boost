# Power Supply Test Report VBA Tool

電源供應器測試報告自動化工具 - 將 TXT 格式的測試設備輸出轉換為格式化的 Excel 報表

## 📋 專案概述

這是一個基於 VBA 的自動化工具，專為電源供應器測試報告處理而設計。可將測試設備產生的 TXT 文字檔案自動轉換成格式化、包含統計分析和圖表的專業 Excel 報表。

### 效能提升

- **處理時間**：從 30-60 分鐘縮短至 **10-30 秒**
- **效率提升**：**99%**
- **自動化程度**：完全自動化，無需手動處理

## ✨ 核心功能

### 支援的測試類型 (7 種)

1. **Turn On Test** - 啟動測試
2. **Hold Up Test** - 保持測試 (Tds, Tdl)
3. **Short Circuit Test** - 短路測試
4. **Combine Test** - 組合測試 (Vdc1-3, Vpp1-3)
5. **OLP Test** - 過載保護測試
6. **Dynamic Test** - 動態測試 (Vs1, Vs2)
7. **Input/Output Test** - 輸入/輸出測試

### Input/Output 子類型 (4 種)

- **InputOutput_Iin** - 輸入電流測試 (Iin<)
- **InputOutput_Pin** - 輸入功率測試 (Pin<)
- **InputOutput_Eff** - 效率測試 (Eff>)
- **InputOutput_General** - 通用測試 (包含 Vin 讀值)

### 主要特色

- ✅ **多檔案匯入**：可同時選擇多個 TXT 檔案進行合併處理
- ✅ **自動格式化**：專業配色方案、分組顯示
- ✅ **統計分析**：自動計算 Maximum/Minimum 值
- ✅ **異常標記處理**：`??` 標記自動以紅色粗體顯示
- ✅ **水平對齊系統**：所有測試類型的 S/N 行自動對齊
- ✅ **圖表生成**：自動產生分布圖表和平均線
- ✅ **凍結窗格**：方便查看大量數據

## 🚀 快速開始

### 系統需求

- Microsoft Excel 2010 或更新版本
- 啟用巨集功能

### 使用步驟

1. **開啟 Excel 檔案**
   ```
   開啟 EXCEL_TO_TXT.xlsm
   ```

2. **執行匯入巨集**
   - 按下 `Alt + F8`
   - 選擇 `ImportTurnOnTestReport`
   - 點擊「執行」

3. **選擇 TXT 檔案**
   - 可以選擇單一檔案或多個檔案（按住 Ctrl 多選）
   - 系統會自動合併處理

4. **等待處理完成**
   - 程式會自動生成格式化的報表
   - 完成後提示儲存位置

## 📁 專案結構

```
txt_to_excel/
├── EXCEL_TO_TXT.xlsm          # 主要的 Excel 巨集檔案
├── 71修改顏色.txt              # VBA 原始碼（文字格式）
├── CLAUDE.md                  # Claude Code 指引文件
├── vba_complete_doc.md        # 完整開發文件
├── README.md                  # 本文件
└── .gitignore                 # Git 忽略規則
```

## 🎨 色彩配置

使用專業、柔和的配色方案：

| 元素 | RGB | 說明 |
|------|-----|------|
| 標題背景 | (189, 215, 238) | 淺藍色 - 區段標題 |
| S/N 行 | (179, 229, 252) | 淺藍色 - 序號標題 |
| 數據行 | (225, 245, 254) | 極淺藍色 - 讀值數據 |
| 條件標題 | (255, 224, 178) | 淺橘色 - 參數標籤 |
| 參數值 | (255, 249, 196) | 淺黃色 - 參數數據 |
| 異常標記 | (255, 0, 0) | 紅色粗體 - `??` 值 |

### Combine 測試特殊配色

- **Value-1**: (189, 215, 238) 藍色
- **Value-2**: (198, 224, 180) 綠色
- **Value-3**: (255, 228, 181) 橙色

## 🔧 技術細節

### 架構概述

1. **序列識別** (`FindAllSequences`) - 掃描 TXT 檔案，識別所有測試類型
2. **參數提取** - 各測試類型特定的參數提取函數
3. **數據提取** - 提取序號讀值數據
4. **Excel 格式化** - 建立格式化區段
5. **圖表生成** - 自動產生分布圖表
6. **最終調整** - 套用凍結窗格、調整欄寬

### 多檔案合併策略

- **第一個檔案**：保留完整內容（標題 + SEQ + 參數 + 讀值）
- **第 2+ 檔案**：只保留讀值部分（從 Serial No 開始）
- 自動跳過重複的 SEQ 標題和參數資訊

### 異常數據處理

測試設備會用 `??` 標記可疑讀值（例如：`123??`, `0.125??`）

- **顯示**：保留原始 `??` 標記，以紅色粗體顯示
- **計算**：移除 `??` 後進行 MAX/MIN 計算

## 📝 開發歷史

詳細的開發歷史和功能演進請參考：
- [vba_complete_doc.md](vba_complete_doc.md) - 完整開發文件
- [CLAUDE.md](CLAUDE.md) - Claude Code 使用指引

## 🤝 貢獻

本專案使用 [Claude Code](https://claude.com/claude-code) 協助開發。

### 報告問題

如果您發現任何問題或有改進建議，請：
1. 檢查現有的 Issues
2. 建立新的 Issue 並詳細描述問題

## 📄 授權

本專案僅供學習和參考使用。

## 🙏 致謝

- 感謝 Claude Code 在開發過程中提供的協助
- 感謝所有測試和回饋的使用者

---

**Last Updated**: 2025-11-25
**Version**: 1.0.0
**Status**: ✅ 穩定版本（多檔案合併完成）
