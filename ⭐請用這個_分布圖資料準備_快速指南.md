# ⭐ 分布圖資料準備功能 - 快速指南

## 🎯 功能簡介

在「72-多檔案處理加分布圖.txt」執行完成後，**自動新增「Distribution Data」工作表**，包含：

- ✅ 從第一頁複製所有 SEQ 的參數
- ✅ 從第一頁複製所有測試讀值資料
- ✅ 自動計算頻率分布
- ✅ 預留圖表空間（先不生成圖表）

## 🚀 3 步驟快速整合

### 步驟 1：複製新程式碼

1. 開啟檔案：`分布圖資料準備_新增程式碼.txt`
2. **全選**（Ctrl+A）
3. **複製**（Ctrl+C）

### 步驟 2：貼到 VBA 模組最後面

1. 開啟 `EXCEL_TO_TXT.xlsm`
2. 按 `Alt + F11` 開啟 VBA 編輯器
3. 找到現有的程式碼模組
4. **捲動到最底部**（Ctrl+End）
5. **貼上**（Ctrl+V）
6. **儲存**（Ctrl+S）

### 步驟 3：加入一行呼叫

在 `ImportTurnOnTestReport` 主程式中，找到這行：

```vba
    ' Status: Saving file
    Application.StatusBar = "Saving file..."
```

**在它的前面**加入這 2 行：

```vba
    ' 建立分布圖資料表格
    Application.StatusBar = "Preparing distribution chart data..."
    Call PrepareDistributionChartData(newWb)
```

完整看起來像這樣：

```vba
    ws.Activate
    ws.Range("A1").Select

    ' 建立分布圖資料表格
    Application.StatusBar = "Preparing distribution chart data..."
    Call PrepareDistributionChartData(newWb)

    ' Status: Saving file
    Application.StatusBar = "Saving file..."
    Dim savedPath As String
    savedPath = SaveWithCustomName(newWb, modelName, customerName, testDate, unitCount)
```

**儲存**（Ctrl+S），完成！

## ✅ 測試

1. 關閉 VBA 編輯器（Alt+Q）
2. 執行巨集：`ImportTurnOnTestReport`
3. 選擇測試 TXT 檔案
4. 處理完成後，檢查是否有「**Distribution Data**」工作表

## 📊 預期結果

新的「Distribution Data」工作表會包含：

### 每個 SEQ 區塊（水平排列）

```
┌────────────────────────────────────────────┐
│ SEQ.2: Load Regulation Test               │
├──────────┬──────┬──────────┬────┬─────────┤
│Condition │Value │VdcRead1  │Freq│[圖表預留]│
│Vin       │24    │4.55      │1   │         │
│VdcMax    │5.5   │5.28      │3   │         │
│VdcMin    │5.2   │5.29      │5   │         │
└──────────┴──────┴──────────┴────┴─────────┘
  參數表(2欄)      數據表(2欄)    圖表空間
```

### 格式特點

- 🔴 **Max 參數**：紅色粗體
- 🟢 **Min 參數**：綠色粗體
- 🟠 **參數表頭**：橘色背景
- 🔵 **數據表頭**：藍色背景 + 白字
- 📊 **頻率**：自動計算並從小到大排序

## 💡 重要提醒

1. ✅ **不影響原功能**：所有新程式碼都是獨立的
2. ✅ **先做資料，後做圖**：目前只準備資料表格，圖表之後再做
3. ✅ **不修改基本程式碼**：只加入新函數和一行呼叫
4. ⚠️ **確認資料正確**：先檢查資料表格是否正確，再考慮做圖表

## 🐛 遇到問題？

### 問題 1：沒有建立新工作表

**檢查**：
- 是否忘記加入 `Call PrepareDistributionChartData(newWb)` 這行？
- 按 Ctrl+G 開啟即時運算視窗，看看有無錯誤訊息

### 問題 2：表格是空的

**檢查**：
- 第一頁是否有正確的 SEQ 標題？（例如：SEQ.2: Load Regulation Test）
- 是否有 Condition/Value 參數表？
- 是否有 S/N 行和讀值欄位？

### 問題 3：編譯錯誤

**檢查**：
- 是否完整複製了「分布圖資料準備_新增程式碼.txt」的所有內容？
- 是否貼到正確的模組中？

## 📞 更詳細的說明

如需更詳細的整合說明和故障排除，請參考：
- 📄 `分布圖資料準備_整合指南.md`

---

**最後更新**：2025-12-09
**檔案準備**：
- ✅ `分布圖資料準備_新增程式碼.txt` - 完整 VBA 程式碼
- ✅ `分布圖資料準備_整合指南.md` - 詳細整合指南
- ✅ 本文件 - 快速指南

**祝您使用順利！** 🎉
