========================================
分布圖功能 - 水平佈局完整修復版
最後更新：2025-12-07
========================================

【問題診斷】
1. 所有圖表擠在左邊（A-E 欄）- 沒有水平排列
2. 長條圖沒有正確顯示
3. 每個 SEQ 沒有獨立的資料區域

【根本原因】
- CreateDistributionChartsForAllSequences 函數需要改用水平佈局版本
- 每個測試類型的函數需要正確使用 WriteDistributionDataToSheet_New
- 圖表需要正確配置資料來源

【解決方案】
將原本的 CreateDistributionChartsForAllSequences 替換為以下完整版本


========================================
主控函數：GenerateSEQDistributionCharts
========================================

' 【使用者調用】生成 SEQ 分布圖（水平佈局）
Sub GenerateSEQDistributionCharts()
    On Error GoTo ErrorHandler

    ' 取得 TXT 檔案路徑
    Dim filePath As String
    filePath = Application.GetOpenFilename("Text Files (*.txt), *.txt", , "選擇 TXT 檔案")
    If filePath = "False" Then Exit Sub

    ' 讀取檔案內容
    Dim lines() As String
    ReDim lines(0)

    Dim fso As Object, txtFile As Object, lineCount As Long, content As String
    Set fso = CreateObject("Scripting.FileSystemObject")
    Set txtFile = fso.OpenTextFile(filePath, 1, False)

    content = txtFile.ReadAll
    txtFile.Close
    Set txtFile = Nothing
    Set fso = Nothing

    lines = Split(content, vbCrLf)
    If UBound(lines) = -1 Then
        lines = Split(content, vbLf)
    End If

    ' 找到所有測試序列
    Dim allSequences As Collection
    Set allSequences = FindAllSequences(lines)

    If allSequences.Count = 0 Then
        MsgBox "沒有找到任何測試序列！", vbExclamation
        Exit Sub
    End If

    ' 生成分布圖（使用水平佈局）
    Call CreateDistributionChartsForAllSequences_H(allSequences, lines)

    MsgBox "分布圖生成完成！", vbInformation
    Exit Sub

ErrorHandler:
    MsgBox "錯誤：" & Err.Description, vbCritical
End Sub


========================================
主控函數：CreateDistributionChartsForAllSequences_H
========================================

' 【重要】為所有測試序列生成分布圖（水平三區塊佈局）
Sub CreateDistributionChartsForAllSequences_H(allSequences As Collection, lines() As String)
    ' 創建「分佈圖」工作表
    Dim ws As Worksheet
    On Error Resume Next
    Set ws = ThisWorkbook.Worksheets("分佈圖")
    On Error GoTo 0

    If ws Is Nothing Then
        Set ws = ThisWorkbook.Worksheets.Add
        ws.Name = "分佈圖"
    Else
        ' 清空現有內容
        ws.Cells.Clear
        ws.ChartObjects.Delete
    End If

    ' SEQ 配色方案
    Dim seqColors As Object
    Set seqColors = CreateObject("Scripting.Dictionary")
    seqColors.Add "TurnOn", RGB(68, 114, 196)        ' 藍色
    seqColors.Add "HoldUp", RGB(237, 125, 49)        ' 橘色
    seqColors.Add "ShortCircuit", RGB(165, 165, 165) ' 灰色
    seqColors.Add "Combine", RGB(255, 192, 0)        ' 金色
    seqColors.Add "OLP", RGB(91, 155, 213)           ' 淺藍色
    seqColors.Add "Dynamic", RGB(112, 48, 160)       ' 紫色
    seqColors.Add "LoadRegulation", RGB(0, 176, 80)  ' 綠色
    seqColors.Add "InputOutput_Iin", RGB(255, 0, 0)  ' 紅色
    seqColors.Add "InputOutput_Pin", RGB(192, 0, 0)  ' 深紅色
    seqColors.Add "InputOutput_Eff", RGB(146, 208, 80) ' 淺綠色
    seqColors.Add "InputOutput_General", RGB(0, 176, 240) ' 天藍色

    ' 水平佈局：每個 SEQ 佔用 10 欄，從第 1 欄開始
    Dim currentCol As Long
    currentCol = 1

    Dim seqInfo As Object
    For Each seqInfo In allSequences
        Dim testType As String
        testType = seqInfo("type")

        ' 取得 SEQ 配色
        Dim seqColor As Long
        If seqColors.Exists(testType) Then
            seqColor = seqColors(testType)
        Else
            seqColor = RGB(100, 100, 100)  ' 預設灰色
        End If

        ' 根據測試類型調用對應函數（水平版本）
        Dim colsUsed As Long
        colsUsed = 0

        Select Case testType
            Case "TurnOn"
                colsUsed = CreateTurnOnDistributionCharts_H(ws, seqInfo, lines, currentCol, seqColor)
            Case "HoldUp"
                colsUsed = CreateHoldUpDistributionCharts_H(ws, seqInfo, lines, currentCol, seqColor)
            Case "ShortCircuit"
                colsUsed = CreateShortCircuitDistributionCharts_H(ws, seqInfo, lines, currentCol, seqColor)
            Case "Combine"
                colsUsed = CreateCombineDistributionCharts_H(ws, seqInfo, lines, currentCol, seqColor)
            Case "OLP"
                colsUsed = CreateOLPDistributionCharts_H(ws, seqInfo, lines, currentCol, seqColor)
            Case "Dynamic"
                colsUsed = CreateDynamicDistributionCharts_H(ws, seqInfo, lines, currentCol, seqColor)
            Case "LoadRegulation"
                colsUsed = CreateLoadRegulationDistributionCharts_H(ws, seqInfo, lines, currentCol, seqColor)
            Case "InputOutput_Iin", "InputOutput_Pin", "InputOutput_Eff", "InputOutput_General"
                colsUsed = CreateInputOutputDistributionCharts_H(ws, seqInfo, lines, currentCol, seqColor)
        End Select

        ' 更新下一個 SEQ 的起始欄位
        If colsUsed > 0 Then
            currentCol = currentCol + colsUsed + 1  ' SEQ 間隔 1 欄
        End If
    Next seqInfo

    ' 美化工作表
    ws.Columns.AutoFit
    ws.Activate

    MsgBox "分佈圖生成完成！共處理 " & allSequences.Count & " 個測試序列", vbInformation
End Sub


========================================
測試類型函數：Load Regulation（範例）
========================================

' Load Regulation 分布圖（水平版）
Function CreateLoadRegulationDistributionCharts_H(ws As Worksheet, _
                                                   seqInfo As Object, _
                                                   lines() As String, _
                                                   startCol As Long, _
                                                   seqColor As Long) As Long
    ' 提取參數和讀值
    Dim params As Object
    Set params = ExtractLoadRegulationParams(lines, seqInfo("startLine"), seqInfo("loadName"))

    Dim readData As Object
    Set readData = ExtractAllLoadRegulationReads(lines, seqInfo("title"))

    If readData.Count = 0 Then
        CreateLoadRegulationDistributionCharts_H = 0
        Exit Function
    End If

    ' ===== SEQ 標題（橫跨整個區域）=====
    ws.Cells(1, startCol).Value = seqInfo("title")
    ws.Cells(1, startCol).Font.Bold = True
    ws.Cells(1, startCol).Font.Size = 14
    ws.Cells(1, startCol).Interior.Color = seqColor
    ws.Cells(1, startCol).Font.Color = RGB(255, 255, 255)

    ' 合併儲存格（橫跨 10 欄）
    ws.Range(ws.Cells(1, startCol), ws.Cells(1, startCol + 9)).Merge
    ws.Cells(1, startCol).HorizontalAlignment = xlCenter
    ws.Cells(1, startCol).VerticalAlignment = xlCenter

    ' ===== 生成各讀值的分布圖 =====
    Dim currentRow As Long
    currentRow = 3

    ' Load Regulation 讀值清單
    Dim readingNames As Variant
    readingNames = Array("VdcRead1", "VppRead1", "VdcRead2", "VppRead2", _
                        "VdcRead3", "VppRead3", "VnRead1", "VnRead2", _
                        "VnRead3", "dV21", "dV31")

    Dim i As Integer
    For i = LBound(readingNames) To UBound(readingNames)
        Dim readingName As String
        readingName = CStr(readingNames(i))

        ' 收集該讀值的所有數據
        Dim readingValues As Collection
        Set readingValues = CollectReadingValues(readData, readingName)

        If readingValues.Count > 0 Then
            ' 取得 Spec Max/Min
            Dim specMax As Variant, specMin As Variant
            specMax = ""
            specMin = ""
            Call GetSpecForReading(readingName, params, specMax, specMin)

            ' 處理數據（四捨五入、去重、排序）
            Dim processedData As Collection
            Set processedData = ProcessReadingValues(readingValues)

            If processedData.Count > 0 Then
                ' 計算頻率
                Dim freqData As Object
                Set freqData = CalculateFrequencyData(readingValues, processedData)

                ' 寫入三區塊資料（資料表 + 參數表）
                Dim tableHeight As Long
                tableHeight = WriteDistributionDataToSheet_New(ws, freqData, specMax, specMin, currentRow, startCol, readingName)

                ' 檢查是否有參數
                Dim hasParams As Boolean
                hasParams = (specMax <> "" And specMax <> "*") Or (specMin <> "" And specMin <> "*")

                ' 生成圖表（在資料表右側）
                Dim chartStartCol As Long
                If hasParams Then
                    chartStartCol = startCol + 4  ' 資料表(2欄) + 參數表(2欄)
                Else
                    chartStartCol = startCol + 2  ' 資料表(2欄)
                End If

                ' 創建圖表物件
                Dim chartObj As ChartObject
                On Error Resume Next
                Set chartObj = ws.ChartObjects.Add( _
                    Left:=ws.Cells(currentRow, chartStartCol).Left, _
                    Top:=ws.Cells(currentRow, chartStartCol).Top, _
                    Width:=450, _
                    Height:=280)

                If Err.Number = 0 Then
                    On Error GoTo 0
                    ' 配置圖表
                    Call ConfigureDistributionChart_New(chartObj.Chart, ws, readingName, currentRow, startCol, tableHeight)
                Else
                    Debug.Print "圖表創建錯誤：" & Err.Description
                    Err.Clear
                End If
                On Error GoTo 0

                ' 計算區塊高度並移動到下一個讀值
                Dim chartRowHeight As Long
                chartRowHeight = 18

                If chartRowHeight > tableHeight Then
                    currentRow = currentRow + chartRowHeight + 2
                Else
                    currentRow = currentRow + tableHeight + 2
                End If
            End If
        End If
    Next i

    ' 返回佔用的欄數（資料2欄 + 參數2欄 + 圖表6欄）
    CreateLoadRegulationDistributionCharts_H = 10
End Function


========================================
核心函數：WriteDistributionDataToSheet_New
========================================

' 寫入分布資料（三區塊水平佈局）
Function WriteDistributionDataToSheet_New(ws As Worksheet, _
                                          freqData As Object, _
                                          specMax As Variant, _
                                          specMin As Variant, _
                                          startRow As Long, _
                                          startCol As Long, _
                                          readingName As String) As Long
    ' 返回值：佔用的列數（最大高度）

    ' ===== 1. 建立完整數據集合（包含 MAX/Min 特殊點）=====
    Dim allData As Object
    Set allData = CreateObject("Scripting.Dictionary")

    ' 添加頻率數據
    Dim key As Variant
    For Each key In freqData.Keys
        Dim valueLabel As String
        valueLabel = CStr(CDbl(key))
        allData.Add valueLabel, Array(CDbl(key), freqData(key), "normal")
    Next key

    ' 添加 Spec Max 特殊點（如果有且不存在相同值）
    If specMax <> "" And specMax <> "*" Then
        Dim maxLabel As String
        maxLabel = CStr(CDbl(specMax)) & "_MAX"

        Dim maxExists As Boolean
        maxExists = False
        For Each key In freqData.Keys
            If Abs(CDbl(key) - CDbl(specMax)) < 0.0001 Then
                maxExists = True
                Exit For
            End If
        Next key

        If Not maxExists Then
            allData.Add maxLabel, Array(CDbl(specMax), Empty, "max")
        End If
    End If

    ' 添加 Spec Min 特殊點（如果有且不存在相同值）
    If specMin <> "" And specMin <> "*" Then
        Dim minLabel As String
        minLabel = CStr(CDbl(specMin)) & "_Min"

        Dim minExists As Boolean
        minExists = False
        For Each key In freqData.Keys
            If Abs(CDbl(key) - CDbl(specMin)) < 0.0001 Then
                minExists = True
                Exit For
            End If
        Next key

        If Not minExists Then
            allData.Add minLabel, Array(CDbl(specMin), Empty, "min")
        End If
    End If

    ' ===== 2. 排序（從大到小）=====
    Dim sortedLabels() As String
    Dim sortedValues() As Double
    ReDim sortedLabels(1 To allData.Count)
    ReDim sortedValues(1 To allData.Count)

    Dim idx As Long
    idx = 1
    For Each key In allData.Keys
        sortedLabels(idx) = CStr(key)
        sortedValues(idx) = allData(key)(0)
        idx = idx + 1
    Next key

    ' 氣泡排序（從大到小）
    Dim i As Long, j As Long
    Dim tempLabel As String, tempValue As Double
    For i = 1 To UBound(sortedValues) - 1
        For j = i + 1 To UBound(sortedValues)
            If sortedValues(i) < sortedValues(j) Then
                tempLabel = sortedLabels(i)
                sortedLabels(i) = sortedLabels(j)
                sortedLabels(j) = tempLabel

                tempValue = sortedValues(i)
                sortedValues(i) = sortedValues(j)
                sortedValues(j) = tempValue
            End If
        Next j
    Next i

    ' ===== 3. 寫入區塊1：圖表資料（2欄）=====
    Dim dataCol As Long
    dataCol = startCol

    ' 表頭
    ws.Cells(startRow, dataCol).Value = readingName
    ws.Cells(startRow, dataCol + 1).Value = "Frequency"

    ' 表頭格式
    With ws.Range(ws.Cells(startRow, dataCol), ws.Cells(startRow, dataCol + 1))
        .Font.Bold = True
        .Interior.Color = RGB(68, 114, 196)
        .Font.Color = RGB(255, 255, 255)
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .Borders.LineStyle = xlContinuous
        .Borders.Weight = xlThin
    End With

    ' 設置欄寬
    ws.Columns(dataCol).ColumnWidth = 15
    ws.Columns(dataCol + 1).ColumnWidth = 12

    ' 寫入數據
    Dim row As Long
    row = startRow + 1

    For i = 1 To UBound(sortedLabels)
        Dim dataLabel As String
        dataLabel = sortedLabels(i)

        Dim dataInfo As Variant
        dataInfo = allData(dataLabel)

        Dim dataType As String
        dataType = dataInfo(2)

        ' 寫入第一欄（讀值標籤）
        ws.Cells(row, dataCol).Value = dataLabel

        ' 寫入第二欄（頻率）
        If IsEmpty(dataInfo(1)) Then
            ws.Cells(row, dataCol + 1).Value = ""
        Else
            ws.Cells(row, dataCol + 1).Value = dataInfo(1)
        End If

        ' 設置格式
        Select Case dataType
            Case "max"
                ws.Cells(row, dataCol).Font.Color = RGB(255, 0, 0)
                ws.Cells(row, dataCol).Font.Bold = True
                ws.Cells(row, dataCol).Interior.Color = RGB(255, 230, 230)
            Case "min"
                ws.Cells(row, dataCol).Font.Color = RGB(0, 176, 80)
                ws.Cells(row, dataCol).Font.Bold = True
                ws.Cells(row, dataCol).Interior.Color = RGB(230, 255, 230)
            Case "normal"
                ws.Cells(row, dataCol).Font.Color = RGB(0, 0, 0)
                ws.Cells(row, dataCol + 1).Font.Color = RGB(0, 0, 0)
        End Select

        ' 設置對齊和邊框
        With ws.Range(ws.Cells(row, dataCol), ws.Cells(row, dataCol + 1))
            .HorizontalAlignment = xlCenter
            .VerticalAlignment = xlCenter
            .Borders.LineStyle = xlContinuous
            .Borders.Weight = xlThin
        End With

        row = row + 1
    Next i

    Dim dataTableHeight As Long
    dataTableHeight = row - startRow

    ' ===== 4. 寫入區塊2：參數表（2欄，僅當有參數時）=====
    Dim hasParams As Boolean
    hasParams = (specMax <> "" And specMax <> "*") Or (specMin <> "" And specMin <> "*")

    Dim paramTableHeight As Long
    paramTableHeight = 0

    If hasParams Then
        Dim paramCol As Long
        paramCol = dataCol + 2

        ' 表頭
        ws.Cells(startRow, paramCol).Value = "Condition"
        ws.Cells(startRow, paramCol + 1).Value = "Value"

        ' 表頭格式
        With ws.Range(ws.Cells(startRow, paramCol), ws.Cells(startRow, paramCol + 1))
            .Font.Bold = True
            .Interior.Color = RGB(255, 224, 178)
            .Font.Color = RGB(0, 0, 0)
            .HorizontalAlignment = xlCenter
            .VerticalAlignment = xlCenter
            .Borders.LineStyle = xlContinuous
            .Borders.Weight = xlThin
        End With

        ' 設置欄寬
        ws.Columns(paramCol).ColumnWidth = 12
        ws.Columns(paramCol + 1).ColumnWidth = 10

        ' 寫入參數數據
        Dim paramRow As Long
        paramRow = startRow + 1

        ' 根據讀值名稱確定參數名稱
        Dim maxParamName As String, minParamName As String
        Call GetParamNamesForReading(readingName, maxParamName, minParamName)

        ' 寫入 Max 參數
        If specMax <> "" And specMax <> "*" Then
            ws.Cells(paramRow, paramCol).Value = maxParamName
            ws.Cells(paramRow, paramCol + 1).Value = specMax

            ws.Cells(paramRow, paramCol).Font.Color = RGB(255, 0, 0)
            ws.Cells(paramRow, paramCol + 1).Font.Color = RGB(255, 0, 0)
            ws.Cells(paramRow, paramCol).Font.Bold = True
            ws.Cells(paramRow, paramCol + 1).Font.Bold = True

            With ws.Range(ws.Cells(paramRow, paramCol), ws.Cells(paramRow, paramCol + 1))
                .HorizontalAlignment = xlCenter
                .VerticalAlignment = xlCenter
                .Borders.LineStyle = xlContinuous
                .Borders.Weight = xlThin
            End With

            paramRow = paramRow + 1
        End If

        ' 寫入 Min 參數
        If specMin <> "" And specMin <> "*" Then
            ws.Cells(paramRow, paramCol).Value = minParamName
            ws.Cells(paramRow, paramCol + 1).Value = specMin

            ws.Cells(paramRow, paramCol).Font.Color = RGB(0, 176, 80)
            ws.Cells(paramRow, paramCol + 1).Font.Color = RGB(0, 176, 80)
            ws.Cells(paramRow, paramCol).Font.Bold = True
            ws.Cells(paramRow, paramCol + 1).Font.Bold = True

            With ws.Range(ws.Cells(paramRow, paramCol), ws.Cells(paramRow, paramCol + 1))
                .HorizontalAlignment = xlCenter
                .VerticalAlignment = xlCenter
                .Borders.LineStyle = xlContinuous
                .Borders.Weight = xlThin
            End With

            paramRow = paramRow + 1
        End If

        paramTableHeight = paramRow - startRow
    End If

    ' ===== 5. 返回最大高度 =====
    If paramTableHeight > dataTableHeight Then
        WriteDistributionDataToSheet_New = paramTableHeight
    Else
        WriteDistributionDataToSheet_New = dataTableHeight
    End If
End Function


========================================
核心函數：ConfigureDistributionChart_New
========================================

' 配置圖表（三區塊佈局版本）
Sub ConfigureDistributionChart_New(ch As Chart, _
                                    ws As Worksheet, _
                                    readingName As String, _
                                    dataStartRow As Long, _
                                    dataStartCol As Long, _
                                    tableHeight As Long)

    On Error GoTo ErrorHandler

    ' ===== 1. 確定資料範圍 =====
    Dim lastRow As Long
    lastRow = dataStartRow + tableHeight - 1

    If lastRow <= dataStartRow Then
        Exit Sub
    End If

    ' ===== 2. 定義資料範圍（只有兩欄）=====
    Dim labelRng As Range
    Dim freqRng As Range

    Set labelRng = ws.Range(ws.Cells(dataStartRow + 1, dataStartCol), ws.Cells(lastRow, dataStartCol))
    Set freqRng = ws.Range(ws.Cells(dataStartRow + 1, dataStartCol + 1), ws.Cells(lastRow, dataStartCol + 1))

    ' ===== 3. 清空現有 Series =====
    Do While ch.SeriesCollection.Count > 0
        ch.SeriesCollection(1).Delete
    Loop

    ' ===== 4. 添加主要數據系列（柱狀圖）=====
    Dim s As Series
    Set s = ch.SeriesCollection.NewSeries
    s.Name = "Frequency"
    s.Values = freqRng
    s.XValues = labelRng
    s.ChartType = xlColumnClustered
    s.AxisGroup = xlPrimary
    s.Format.Fill.ForeColor.RGB = RGB(68, 114, 196)

    ' ===== 5. 添加趨勢折線（只連接有數據的點）=====
    Dim trendValues() As Variant
    Dim trendLabels() As Variant
    Dim trendCount As Long
    trendCount = 0

    Dim i As Long
    For i = dataStartRow + 1 To lastRow
        Dim cellValue As String
        cellValue = CStr(ws.Cells(i, dataStartCol).Value)
        If InStr(cellValue, "_MAX") = 0 And InStr(cellValue, "_Min") = 0 Then
            If ws.Cells(i, dataStartCol + 1).Value <> "" Then
                trendCount = trendCount + 1
            End If
        End If
    Next i

    If trendCount > 0 Then
        ReDim trendValues(1 To trendCount)
        ReDim trendLabels(1 To trendCount)

        Dim trendIdx As Long
        trendIdx = 1
        For i = dataStartRow + 1 To lastRow
            cellValue = CStr(ws.Cells(i, dataStartCol).Value)
            If InStr(cellValue, "_MAX") = 0 And InStr(cellValue, "_Min") = 0 Then
                If ws.Cells(i, dataStartCol + 1).Value <> "" Then
                    trendLabels(trendIdx) = ws.Cells(i, dataStartCol).Value
                    trendValues(trendIdx) = ws.Cells(i, dataStartCol + 1).Value
                    trendIdx = trendIdx + 1
                End If
            End If
        Next i

        Set s = ch.SeriesCollection.NewSeries
        s.Name = "Trend"
        s.XValues = trendLabels
        s.Values = trendValues
        s.ChartType = xlLine
        s.AxisGroup = xlPrimary
        With s.Format.Line
            .Weight = 2
            .ForeColor.RGB = RGB(237, 125, 49)
        End With
        s.MarkerStyle = xlMarkerStyleCircle
        s.MarkerSize = 5
    End If

    ' ===== 6. 設置圖表標題與座標軸 =====
    ch.HasTitle = True
    ch.ChartTitle.Text = readingName & " 分佈圖"
    With ch.ChartTitle.Font
        .Size = 14
        .Bold = True
        .Color = RGB(68, 114, 196)
    End With

    ' X 軸
    With ch.Axes(xlCategory)
        .HasTitle = True
        .AxisTitle.Text = "測試值 (Value)"
        .AxisTitle.Font.Size = 11
        .TickLabelSpacing = 1
        .TickMarkSpacing = 1
        .TickLabels.Orientation = 45
    End With

    ' Y 軸
    With ch.Axes(xlValue, xlPrimary)
        .HasTitle = True
        .AxisTitle.Text = "出現次數 (Frequency)"
        .AxisTitle.Font.Size = 11
        .MinimumScale = 0
    End With

    ' ===== 7. 設置圖例 =====
    ch.HasLegend = True
    With ch.Legend
        .Position = xlLegendPositionBottom
        .Font.Size = 10
    End With

    ' ===== 8. 美化圖表區域 =====
    ch.PlotArea.Format.Fill.Visible = msoTrue
    ch.PlotArea.Format.Fill.ForeColor.RGB = RGB(255, 255, 255)

    ch.ChartArea.Format.Fill.Visible = msoTrue
    ch.ChartArea.Format.Fill.ForeColor.RGB = RGB(242, 242, 242)

    Exit Sub

ErrorHandler:
    Debug.Print "!!! 圖表配置錯誤 !!!"
    Debug.Print "錯誤編號：" & Err.Number
    Debug.Print "錯誤描述：" & Err.Description
End Sub


========================================
所有測試類型函數（_H 版本）
========================================

【重要】需要為以下測試類型創建對應的 _H 版本函數：

1. CreateTurnOnDistributionCharts_H
2. CreateHoldUpDistributionCharts_H
3. CreateShortCircuitDistributionCharts_H
4. CreateCombineDistributionCharts_H
5. CreateOLPDistributionCharts_H
6. CreateDynamicDistributionCharts_H
7. CreateInputOutputDistributionCharts_H

所有函數結構與 CreateLoadRegulationDistributionCharts_H 相同，只需調整：
- 讀值清單（readingNames）
- 參數提取函數
- 資料提取函數


========================================
使用步驟
========================================

1. 將以上所有函數複製到 VBA 編輯器中

2. 確保以下輔助函數已存在（重用現有代碼）：
   - CollectReadingValues
   - ProcessReadingValues
   - RoundByValueRange
   - CalculateFrequencyData
   - CleanNumericValue
   - GetSpecForReading
   - GetParamNamesForReading

3. 在主流程中調用：
   Call GenerateSEQDistributionCharts()

4. 測試結果：
   - 每個 SEQ 佔用 10 欄（資料2欄 + 參數2欄 + 圖表6欄）
   - SEQ 之間間隔 1 欄
   - 圖表正確顯示長條圖和趨勢線


========================================
關鍵修正點
========================================

✅ 主控函數改名為 CreateDistributionChartsForAllSequences_H
✅ 所有測試類型函數加上 _H 後綴
✅ 使用 WriteDistributionDataToSheet_New（三區塊佈局）
✅ 使用 ConfigureDistributionChart_New（新版圖表配置）
✅ startCol 從 1 開始，每個 SEQ +11 欄（10 欄內容 + 1 欄間隔）
✅ 圖表起始位置正確計算（startCol + 4 或 startCol + 2）
✅ 資料範圍正確定義（labelRng, freqRng）

========================================
