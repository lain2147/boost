# 分佈圖功能 - 使用說明

## ✅ 最新更新（2025-12-06 v2.0）

### 🎨 新增功能：水平排列布局

**重大改進**：SEQ 分布圖改為水平排列，每個 SEQ 從左到右展開，大幅提升可讀性！

**新布局特點**：
- ✅ **水平排列**：每個 SEQ 橫向展開（從左到右）
- ✅ **SEQ 顏色區分**：每個 SEQ 使用不同顏色的標題（9 種顏色循環）
- ✅ **參數顏色保持**：Condition（橘色）、Value（黃色）
- ✅ **Min/Max 顏色保持**：綠色（Min）、紅色（Max）

**顏色陣列**（依序循環）：
1. 藍色 RGB(68, 114, 196)
2. 綠色 RGB(112, 173, 71)
3. 橙色 RGB(255, 192, 0)
4. 淺藍 RGB(91, 155, 213)
5. 橘紅 RGB(237, 125, 49)
6. 灰色 RGB(165, 165, 165)
7. 黃色 RGB(255, 217, 102)
8. 淡藍 RGB(180, 198, 231)
9. 淡綠 RGB(197, 224, 180)

---

## 🐛 已修正的錯誤（v1.1）

**錯誤類型**：執行階段錯誤 1004 - 無法設定種類 Range 的 Hidden 屬性

**修正位置**：
1. **第 4576 行** - `CreateDistributionChartsForAllSequences` 函數
2. **第 5250 行** - `UnhideDataColumns` 函數
3. **第 5261 行** - `HideDataColumns` 函數

**修正內容**：
```vba
' ❌ 錯誤寫法
ws.Range("A:E").Hidden = True

' ✅ 正確寫法
ws.Columns("A:E").Hidden = True
```

---

## 📁 檔案說明

- **分布圖功能_修正版_可執行.txt** - 修正後的完整可執行版本
- **分布圖功能_超級完整獨立版.txt** - 原始版本（保留備份）

---

## 🚀 使用方法

### 步驟 1：複製 VBA 代碼
1. 開啟 `分布圖功能_修正版_可執行.txt`
2. 全選並複製所有代碼（Ctrl+A → Ctrl+C）

### 步驟 2：貼入 Excel VBA 編輯器
1. 開啟 Excel（建議新建空白活頁簿）
2. 按 `Alt + F11` 開啟 VBA 編輯器
3. 插入 → 模組
4. 將複製的代碼貼上（Ctrl+V）
5. 儲存（Ctrl+S）

### 步驟 3：執行分佈圖生成
1. 按 `F5` 或點擊工具列的「執行」按鈕
2. 在彈出的巨集選單中選擇 `GenerateSEQDistributionCharts`
3. 點擊「執行」
4. 選擇測試報告 TXT 檔案（可多選）
5. 等待處理完成
6. 選擇存檔位置和檔名

---

## 📊 功能特色

### ✨ 支援的測試類型（9種）
1. **Turn On** - 啟動測試
2. **Hold Up** - 保持測試（Tds, Tdl）
3. **Short Circuit** - 短路測試
4. **Combine** - 組合測試（Vdc1-3, Vpp1-3）
5. **OLP** - 過載保護測試
6. **Dynamic** - 動態測試（Vs1, Vs2）
7. **Load Regulation** - 負載調節測試（11 讀值）
8. **InputOutput_Iin** - 輸入電流測試
9. **InputOutput_Pin/Eff/General** - 其他輸入輸出測試

### 📈 圖表特色
- ✅ 自動生成頻率分佈圖（柱狀圖 + 折線圖）
- ✅ 智能顯示 Spec Max/Min 線條（只在讀值觸及時顯示）
- ✅ 左側完整參數表（Condition/Value）
- ✅ 計算數據自動隱藏（A-E 欄）
- ✅ 每個 SEQ 獨立區塊

---

## 🔧 進階功能

### 取消隱藏計算數據
如果需要查看隱藏的計算數據（A-E 欄）：

**方法 1**：使用輔助函數
```vba
' 在 VBA 編輯器中執行
Call UnhideDataColumns
```

**方法 2**：手動操作
1. 選中 A-E 欄標題
2. 右鍵 → 取消隱藏

### 重新隱藏數據
```vba
' 在 VBA 編輯器中執行
Call HideDataColumns
```

---

## 📋 系統需求

- **Excel 版本**：Excel 2010 或更新版本
- **啟用巨集**：必須允許執行巨集
- **記憶體**：建議至少 4GB RAM（處理大型數據集）

---

## ⚠️ 注意事項

1. **多檔案處理**：
   - 第 1 個檔案：保留完整內容（包括 Header）
   - 第 2+ 個檔案：只保留測試數據（跳過 Header）

2. **檔案命名規則**：
   - 自動生成：`ModelName_Customer_Date_XXXpcs_DistributionChart.xlsx`
   - 無效字元會自動替換為底線

3. **效能優化**：
   - 使用批量陣列寫入（減少逐格寫入次數）
   - 關閉螢幕更新和自動計算
   - 處理後自動恢復 Excel 設定

---

## 🆘 常見問題

### Q1: 執行時出現「未找到測試序列」
**A**: 檢查 TXT 檔案格式是否符合預期，確保包含 "SEQ." 和 "Serial No" 關鍵字

### Q2: 圖表顯示不完整
**A**: 確保 TXT 檔案中有足夠的測試數據（至少 2 筆以上）

### Q3: 存檔時提示檔名錯誤
**A**: 檔名中可能包含非法字元（如 `/\:*?"<>|`），系統會自動替換

### Q4: 處理速度很慢
**A**: 大型數據集（100+ 樣本）可能需要 30-60 秒，請耐心等待

---

## 📞 技術支援

如有問題或建議，請記錄：
- Excel 版本
- 錯誤訊息截圖
- TXT 檔案格式範例

---

**最後更新**：2025-12-06
**版本**：v2.0（水平排列版）
**開發者**：shihaotw

**版本歷史**：
- v2.0 (2025-12-06)：新增水平排列布局、SEQ 顏色區分系統
- v1.1 (2025-12-06)：修正 Range.Hidden 錯誤
- v1.0 (2025-12-05)：初始版本
