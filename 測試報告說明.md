# 電源供應器測試報告使用說明

## 📋 目錄

- [TXT 測試報告格式說明](#txt-測試報告格式說明)
- [測試類型分類邏輯](#測試類型分類邏輯)
- [測試類型詳細說明](#測試類型詳細說明)
- [Excel 報告結構](#excel-報告結構)
- [特殊標記說明](#特殊標記說明)

---

## TXT 測試報告格式說明

### 報告來源
TXT 測試報告由電源供應器自動測試設備產生，記錄多台測試樣品（Serial No）的測試結果。

### 報告結構
```
Customer: [客戶名稱]      Serial No: [序號1]
Inspector: [檢驗員]
YYYY_MM_DD: [日期]        Begin Time: [時間]

SEQ.1 Turn On & Sequence Test (115V TURN ON)
[測試參數設定]
[測試讀值數據]

SEQ.2 Hold Up Test
[測試參數設定]
[測試讀值數據]

...

Serial No: [序號2]
SEQ.1 Turn On & Sequence Test (115V TURN ON)
...
```

### 基本資訊
- **Customer**：客戶名稱
- **Inspector**：檢驗員姓名
- **Date**：測試日期
- **Serial No**：測試樣品序號（可包含字母、數字、連字符、底線）

---

## 測試類型分類邏輯

系統自動識別並處理 **9 種測試類型**（7 種基礎測試 + 2 種複合測試）

### 基礎測試類型（7 種）

| 測試類型 | SEQ 標題關鍵字 | 用途說明 |
|---------|---------------|---------|
| **Turn On** | `Turn On` | 開機測試（不含 INRUSH） |
| **Hold Up** | `Hold Up` | 保持時間測試 |
| **Short Circuit** | `Short Circuit` | 短路保護測試 |
| **Combine** | `Combine` | 綜合負載測試（3 組條件） |
| **OLP** | `OLP` | 過載保護測試 |
| **Dynamic** | `Dynamic` | 動態負載測試 |
| **Load Regulation** | `Load Regulation` | 負載調整率測試 |

### Input/Output 測試類型（4 種子類型）

Input/Output 測試使用 **雙層判斷機制** 進行分類：

#### 第一層：標題關鍵字判斷（優先）
| 子類型 | 標題關鍵字 | 說明 |
|--------|-----------|------|
| **InputOutput_Iin** | `Iin<` 或 `Iin <` | 輸入電流限制測試 |
| **InputOutput_Pin** | `Pin<` 或 `Pin <` | 輸入功率限制測試 |
| **InputOutput_Eff** | `Eff>` 或 `Eff.` | 效率測試 |
| **InputOutput_General** | 其他 Input/Output | 通用輸入輸出測試 |

#### 第二層：數據內容判斷（後備方案）
當標題關鍵字判斷不成立時，系統會檢查測試數據內容：

**判斷優先級**：Eff > Iin > Pin > General

| 子類型 | 判斷條件 | 檢查項目 |
|--------|---------|---------|
| **InputOutput_Eff** | Eff Min ≠ `*` | Eff 有設定最小值 |
| **InputOutput_Iin** | Iinrms Max ≠ `*` | Iinrms 有設定最大值 |
| **InputOutput_Pin** | Pin Max ≠ `*` | Pin 有設定最大值 |
| **InputOutput_General** | 以上都不滿足 | 預設類型 |

**範例**：
```
測試數據：
            Max      Min    Reading
Iinrms         *        *      0.381
Pin            *        *      9.144
Eff       99.000   83.000     87.281

判斷結果：InputOutput_Eff（因為 Eff Min = 83.000）
```

---

## 測試類型詳細說明

### 1. Turn On Test（開機測試）

**測試目的**：驗證電源開機時序和時間

#### 測試參數（12 個）
| 參數組 | 參數名稱 | 說明 |
|--------|---------|------|
| **Phase Delay** | ON Phase delay | 開機相位延遲 |
| | OFF Phase delay | 關機相位延遲 |
| **輸入設定** | Vin | 輸入電壓 |
| | Fin | 輸入頻率 |
| **負載參數** | Load Name | 負載名稱（如 12V） |
| | MODE | 負載模式 |
| | Ifs | 滿載電流 |
| | Vfs | 滿載電壓 |
| **測試規格** | Von | 觸發電壓 |
| | I/R | 電流/電阻 |
| | Va | 參考電壓 |
| | Ton Max | 開機時間上限 |

#### 讀值（1 個）
- **Ton Read**：實際開機時間測量值

#### Excel 報告欄位
- S/N（序號）
- [Load Name]_Ton Read
- Maximum（最大值）
- Minimum（最小值）

---

### 2. Hold Up Test（保持時間測試）

**測試目的**：測試電源斷電後的保持時間

#### 測試參數（10 個）
| 參數組 | 參數名稱 | 說明 |
|--------|---------|------|
| **輸入設定** | Vin | 輸入電壓 |
| | Fin | 輸入頻率 |
| **負載參數** | Load Name | 負載名稱 |
| | MODE | 負載模式 |
| | Ifs | 滿載電流 |
| | Vfs | 滿載電壓 |
| **觸發設定** | Von | 觸發電壓 |
| | I/R | 電流/電阻 |
| | Va | 參考電壓 |
| **保持時間規格** | Thd Min | 保持時間下限 |

#### 讀值（2 個）
- **Tds**：短時間保持時間
- **Tdl**：長時間保持時間

#### Excel 報告欄位
- S/N
- [Load Name]_Tds
- [Load Name]_Tdl
- Maximum
- Minimum

---

### 3. Short Circuit Test（短路保護測試）

**測試目的**：驗證短路保護功能

#### 測試參數（8 個）
| 參數組 | 參數名稱 | 說明 |
|--------|---------|------|
| **輸入設定** | Vin | 輸入電壓 |
| | Fin | 輸入頻率 |
| **測試設定** | Which Load | 測試負載編號 |
| **負載參數** | Load Name | 負載名稱 |
| | MODE | 負載模式 |
| | Ifs | 滿載電流 |
| | Vfs | 滿載電壓 |
| | I/R | 電流/電阻 |

#### 讀值（1 個）
- **Pin**：輸入功率測量值

#### Excel 報告欄位
- S/N
- [Load Name]_Pin
- Maximum
- Minimum

---

### 4. Combine Test（綜合負載測試）

**測試目的**：在 3 組不同條件下測試輸出電壓

#### 測試參數（17 個）
| 參數組 | 參數名稱 | 說明 |
|--------|---------|------|
| **Value-1 條件** | Vin-1 | 條件 1 輸入電壓 |
| | Fac-1 | 條件 1 頻率 |
| | I/R-1 | 條件 1 電流/電阻 |
| **Value-2 條件** | Vin-2 | 條件 2 輸入電壓 |
| | Fac-2 | 條件 2 頻率 |
| | I/R-2 | 條件 2 電流/電阻 |
| **Value-3 條件** | Vin-3 | 條件 3 輸入電壓 |
| | Fac-3 | 條件 3 頻率 |
| | I/R-3 | 條件 3 電流/電阻 |
| **負載參數** | Load Name | 負載名稱 |
| | MODE | 負載模式 |
| | Ifs | 滿載電流 |
| | Vfs | 滿載電壓 |
| | Noise Filter | 雜訊濾波設定 |
| **電壓規格** | Vdc Max | DC 電壓上限 |
| | Vdc Min | DC 電壓下限 |
| | Vpp Max | Peak-to-Peak 電壓上限 |

#### 讀值（6 個）
- **Vdc-1 RD**：條件 1 DC 電壓讀值
- **Vpp-1 RD**：條件 1 Peak-to-Peak 電壓讀值
- **Vdc-2 RD**：條件 2 DC 電壓讀值
- **Vpp-2 RD**：條件 2 Peak-to-Peak 電壓讀值
- **Vdc-3 RD**：條件 3 DC 電壓讀值
- **Vpp-3 RD**：條件 3 Peak-to-Peak 電壓讀值

#### Excel 報告欄位（色彩分組）
- S/N
- **藍色組** (Value-1)：[Load Name]_Vdc-1 RD、[Load Name]_Vpp-1 RD
- **綠色組** (Value-2)：[Load Name]_Vdc-2 RD、[Load Name]_Vpp-2 RD
- **橙色組** (Value-3)：[Load Name]_Vdc-3 RD、[Load Name]_Vpp-3 RD
- Maximum
- Minimum

---

### 5. OLP Test（過載保護測試）

**測試目的**：驗證過載保護功能

#### 測試參數（10 個）
| 參數組 | 參數名稱 | 說明 |
|--------|---------|------|
| **輸入設定** | Vin | 輸入電壓 |
| | Fin | 輸入頻率 |
| **測試設定** | Test on LOAD | 測試負載編號 |
| **負載參數** | Load Name | 負載名稱 |
| | MODE | 負載模式 |
| | Ifs | 滿載電流 |
| | Vfs | 滿載電壓 |
| | I/R | 電流/電阻 |
| **跳脫規格** | Trip Point_Max | 跳脫點上限 |
| | Trip Point_Min | 跳脫點下限 |

#### 讀值（1 個）
- **Trip Point_Min_Reading**：跳脫點測量值

#### Excel 報告欄位
- S/N
- [Load Name]_Trip Point_Min_Reading
- Maximum
- Minimum

---

### 6. Dynamic Test（動態負載測試）

**測試目的**：測試動態負載下的電壓穩定性

#### 測試參數（15 個）
| 參數組 | 參數名稱 | 說明 |
|--------|---------|------|
| **輸入設定** | Vin | 輸入電壓 |
| | Fin | 輸入頻率 |
| **負載參數** | Load Name | 負載名稱 |
| | MODE | 負載模式 |
| | Ifs | 滿載電流 |
| | Vfs | 滿載電壓 |
| | Noise Filter | 雜訊濾波設定 |
| **動態設定** | Period-1 | 週期 1 |
| | Period-2 | 週期 2 |
| | Rise | 上升時間 |
| | Fall | 下降時間 |
| | I/R-1 | 負載 1 電流/電阻 |
| | I/R-2 | 負載 2 電流/電阻 |
| **電壓規格** | Vs Max | 電壓上限 |
| | Vs Min | 電壓下限 |

#### 讀值（2 個）
- **Vs-1 Rd**：負載 1 電壓讀值
- **Vs-2 Rd**：負載 2 電壓讀值

#### Excel 報告欄位
- S/N
- [Load Name]_Vs-1 Rd
- [Load Name]_Vs-2 Rd
- Maximum
- Minimum

---

### 7. Load Regulation Test（負載調整率測試）

**測試目的**：測試不同負載下的電壓調整率

#### 測試參數（22 個）
| 參數組 | 參數名稱 | 說明 |
|--------|---------|------|
| **輸入設定** | Vin | 輸入電壓 |
| | Fin | 輸入頻率 |
| | Delay Time | 延遲時間 |
| | Meas. Time | 測量時間 |
| **負載參數** | Load Name | 負載名稱 |
| | MODE | 負載模式 |
| | Ifs | 滿載電流 |
| | Vfs | 滿載電壓 |
| | Meas | 測量設定 |
| **濾波設定** | Vdc Filter | DC 電壓濾波 |
| | Noise Filter | 雜訊濾波 |
| | Von | 觸發電壓 |
| **負載設定** | BITS-1 | 負載點 1 |
| | BITS-2 | 負載點 2 |
| | BITS-3 | 負載點 3 |
| | SLEW Rate | 轉換速率 |
| | I/R-1 | 負載 1 電流/電阻 |
| | I/R-2 | 負載 2 電流/電阻 |
| | I/R-3 | 負載 3 電流/電阻 |
| **電壓規格** | Vdc Max | DC 電壓上限 |
| | Vdc Min | DC 電壓下限 |
| | Vpp Max | Peak-to-Peak 電壓上限 |

#### 讀值（11 個）
- **VdcRead1**：負載點 1 DC 電壓
- **VdcRead2**：負載點 2 DC 電壓
- **VdcRead3**：負載點 3 DC 電壓
- **VppRead1**：負載點 1 Peak-to-Peak 電壓
- **VppRead2**：負載點 2 Peak-to-Peak 電壓
- **VppRead3**：負載點 3 Peak-to-Peak 電壓
- **VnRead1**：負載點 1 雜訊電壓
- **VnRead2**：負載點 2 雜訊電壓
- **VnRead3**：負載點 3 雜訊電壓
- **dV21**：負載點 2 與 1 的電壓差
- **dV31**：負載點 3 與 1 的電壓差

#### Excel 報告欄位
- S/N
- [Load Name]_VdcRead1/2/3
- [Load Name]_VppRead1/2/3
- [Load Name]_VnRead1/2/3
- [Load Name]_dV21
- [Load Name]_dV31
- Maximum
- Minimum

---

### 8. Input/Output - Iin（輸入電流限制測試）

**識別方式**：
1. 標題包含 `Iin<` 或 `Iin <`
2. 或數據中 Iinrms Max ≠ `*`

#### 測試參數（12 個）
| 參數組 | 參數名稱 | 說明 |
|--------|---------|------|
| **輸入設定** | Vin | 輸入電壓 |
| | Fin | 輸入頻率 |
| **負載參數** | Load Name | 負載名稱 |
| | MODE | 負載模式 |
| | Ifs | 滿載電流 |
| | Vfs | 滿載電壓 |
| | Noise Filter | 雜訊濾波設定 |
| **測試規格** | Iinrms Max | 輸入電流上限 |
| | I/R | 電流/電阻 |
| **電壓規格** | Vdc Max | DC 電壓上限 |
| | Vdc Min | DC 電壓下限 |
| | Vpp Max | Peak-to-Peak 電壓上限 |

#### 讀值（8 個）
- **Iinrms**：輸入電流有效值
- **Pin**：輸入功率
- **Pdc**：DC 功率
- **Eff**：效率
- **Pf**：功率因數
- **Idc Read**：DC 電流讀值
- **Vdc Read**：DC 電壓讀值
- **Vpp Read**：Peak-to-Peak 電壓讀值

#### Excel 報告欄位（含 Load Name 前綴）
- S/N
- [Load Name]_Iinrms
- [Load Name]_Pin
- [Load Name]_Pdc
- [Load Name]_Eff
- [Load Name]_Pf
- [Load Name]_Idc Read
- [Load Name]_Vdc Read
- [Load Name]_Vpp Read
- Maximum
- Minimum

---

### 9. Input/Output - Pin（輸入功率限制測試）

**識別方式**：
1. 標題包含 `Pin<` 或 `Pin <`
2. 或數據中 Pin Max ≠ `*`

#### 測試參數（10 個）
| 參數組 | 參數名稱 | 說明 |
|--------|---------|------|
| **輸入設定** | Vin | 輸入電壓 |
| | Fin | 輸入頻率 |
| **負載參數** | Load Name | 負載名稱 |
| | MODE | 負載模式 |
| | Ifs | 滿載電流 |
| | Vfs | 滿載電壓 |
| | Noise Filter | 雜訊濾波設定 |
| **測試規格** | Pin Max | 輸入功率上限 |
| | I/R | 電流/電阻 |
| **電壓規格** | Vdc Max | DC 電壓上限 |
| | Vdc Min | DC 電壓下限 |
| | Vpp Max | Peak-to-Peak 電壓上限 |

#### 讀值（8 個）
- **Iinrms**：輸入電流有效值
- **Pin**：輸入功率
- **Pdc**：DC 功率
- **Eff**：效率
- **Pf**：功率因數
- **Idc Read**：DC 電流讀值
- **Vdc Read**：DC 電壓讀值
- **Vpp Read**：Peak-to-Peak 電壓讀值

#### Excel 報告欄位（含 Load Name 前綴）
- S/N
- [Load Name]_Iinrms
- [Load Name]_Pin
- [Load Name]_Pdc
- [Load Name]_Eff
- [Load Name]_Pf
- [Load Name]_Idc Read
- [Load Name]_Vdc Read
- [Load Name]_Vpp Read
- Maximum
- Minimum

---

### 10. Input/Output - Eff（效率測試）

**識別方式**：
1. 標題包含 `Eff>` 或 `Eff.`
2. 或數據中 Eff Min ≠ `*`

#### 測試參數（15 個）
| 參數組 | 參數名稱 | 說明 |
|--------|---------|------|
| **輸入設定** | Vin | 輸入電壓 |
| | Fin | 輸入頻率 |
| **負載參數** | Load Name | 負載名稱 |
| | MODE | 負載模式 |
| | Ifs | 滿載電流 |
| | Vfs | 滿載電壓 |
| | Noise Filter | 雜訊濾波設定 |
| **測試規格** | Eff Min | 效率下限 |
| | I/R | 電流/電阻 |
| **電壓規格** | Vin Max | 輸入電壓上限 |
| | Vin Min | 輸入電壓下限 |
| | Vdc Max | DC 電壓上限 |
| | Vdc Min | DC 電壓下限 |
| | Vpp Max | Peak-to-Peak 電壓上限 |

#### 讀值（8 個）
- **Iinrms**：輸入電流有效值
- **Pin**：輸入功率
- **Pdc**：DC 功率
- **Eff**：效率
- **Pf**：功率因數
- **Idc Read**：DC 電流讀值
- **Vdc Read**：DC 電壓讀值
- **Vpp Read**：Peak-to-Peak 電壓讀值

#### Excel 報告欄位（含 Load Name 前綴）
- S/N
- [Load Name]_Iinrms
- [Load Name]_Pin
- [Load Name]_Pdc
- [Load Name]_Eff
- [Load Name]_Pf
- [Load Name]_Idc Read
- [Load Name]_Vdc Read
- [Load Name]_Vpp Read
- Maximum
- Minimum

---

### 11. Input/Output - General（通用輸入輸出測試）

**識別方式**：
- 標題包含 `Input/Output`
- 不符合 Iin、Pin、Eff 的識別條件
- 或數據中 Eff Min、Iinrms Max、Pin Max 都是 `*`

#### 測試參數（15 個）
| 參數組 | 參數名稱 | 說明 |
|--------|---------|------|
| **輸入設定** | Vin | 輸入電壓 |
| | Fin | 輸入頻率 |
| **負載參數** | Load Name | 負載名稱 |
| | MODE | 負載模式 |
| | Ifs | 滿載電流 |
| | Vfs | 滿載電壓 |
| | Noise Filter | 雜訊濾波設定 |
| **測試規格** | Iinrms Max | 輸入電流上限 |
| | I/R | 電流/電阻 |
| **電壓規格** | Vin Max | 輸入電壓上限 |
| | Vin Min | 輸入電壓下限 |
| | Vdc Max | DC 電壓上限 |
| | Vdc Min | DC 電壓下限 |
| | Vpp Max | Peak-to-Peak 電壓上限 |

#### 讀值（8 個）
- **Iinrms**：輸入電流有效值
- **Pin**：輸入功率
- **Pdc**：DC 功率
- **Eff**：效率
- **Pf**：功率因數
- **Vin Read**：輸入電壓讀值
- **Vdc Read**：DC 電壓讀值
- **Vpp Read**：Peak-to-Peak 電壓讀值

#### Excel 報告欄位（含 Load Name 前綴）
- S/N
- [Load Name]_Iinrms
- [Load Name]_Pin
- [Load Name]_Pdc
- [Load Name]_Eff
- [Load Name]_Pf
- [Load Name]_Vin Read
- [Load Name]_Vdc Read
- [Load Name]_Vpp Read
- Maximum
- Minimum

---

## Excel 報告結構

### 工作表命名
格式：`[客戶名稱]_[測試日期]_[樣品數量]pcs`

範例：`ABC_Company_2025-01-15_30pcs`

### 報告布局

#### 1. 橫向排列
所有測試類型橫向排列，方便對照不同測試項目

#### 2. S/N 行對齊
所有測試的 S/N 行在同一水平位置，便於查看

#### 3. 色彩分組

| 測試類型 | 標題色 | 說明 |
|---------|-------|------|
| Turn On | 淺綠色 | RGB(198, 224, 180) |
| Hold Up | 粉紅色 | RGB(255, 218, 224) |
| Short Circuit | 淺藍色 | RGB(189, 215, 238) |
| Combine | 淡橘色 | RGB(230, 184, 175) |
| OLP | 淡橙色 | RGB(256, 228, 181) |
| Dynamic | 淡青色 | RGB(224, 255, 255) |
| Load Regulation | 淺藍色 | RGB(189, 215, 238) |
| Input/Output | 淺橙色 | RGB(255, 235, 205) |

#### 4. 欄位說明

**參數區**：
- 標題行：測試名稱
- Condition/Value 行：參數分類
- 參數行：各項測試條件（米色背景）

**讀值區**：
- S/N 行：序號（淺藍色背景）
- 數據行：測試讀值（淺藍色背景）
- Maximum 行：最大值（粉紅色背景）
- Minimum 行：最小值（綠色背景）

### 特殊格式

#### Combine 測試色彩分組
- **Value-1**（藍色）：條件 1 的參數和讀值
- **Value-2**（綠色）：條件 2 的參數和讀值
- **Value-3**（橙色）：條件 3 的參數和讀值

---

## 特殊標記說明

### `*` 號標記
**意義**：參數未設定或不適用

**處理方式**：
- 在 Excel 報告中，`*` 號參數**不顯示**（包括參數名稱和數值）
- 只顯示有實際數值的參數

**範例**：
```
TXT 原始數據：
Iinrms Max = *        → Excel 中不顯示此參數
Eff Min = 83.000      → Excel 中顯示：Eff Min = 83.000
```

### `??` 異常值標記
**意義**：測試設備標記為可疑或異常的數據

**顯示方式**：
- 保留原始數值和 `??` 標記
- **紅色粗體**顯示，易於識別

**計算方式**：
- MAX/MIN 計算時會**移除 `??` 標記**後進行數值比較
- 確保異常值不影響統計結果

**範例**：
```
原始數據：123.45??
Excel 顯示：123.45?? （紅色粗體）
MAX/MIN 計算：使用 123.45
```

---

## 使用建議

### 1. 查看測試結果
- 檢查 Maximum 和 Minimum 行，確認是否在規格範圍內
- 注意紅色粗體的異常值（`??` 標記）

### 2. 對照測試參數
- 確認測試條件（Vin、Fin、Load 等）符合測試要求
- 檢查各測試類型的識別是否正確

### 3. 數據分析
- 使用 Excel 篩選功能查找特定序號
- 利用 Excel 圖表功能分析數據分布
- 比較不同測試條件下的表現

### 4. 異常處理
- 優先檢查帶 `??` 標記的數據
- 確認 Maximum/Minimum 是否異常
- 必要時重新測試異常樣品

---

## 常見問題

### Q1：為什麼有些參數沒有顯示？
**A**：參數值為 `*` 時表示未設定，系統會自動跳過不顯示。

### Q2：紅色粗體的數據是什麼意思？
**A**：帶 `??` 標記的數據，表示測試設備認為該數據可疑或異常，建議進一步確認。

### Q3：Input/Output 測試有幾種類型？
**A**：共 4 種子類型（Iin、Pin、Eff、General），系統使用雙層判斷機制自動識別。

### Q4：Load Name 前綴的作用是什麼？
**A**：標識不同負載條件下的測試結果，如 `5.3_Iinrms` 表示 5.3V 負載下的輸入電流。

### Q5：如何確認測試類型識別是否正確？
**A**：檢查 Excel 報告的標題欄和參數設定，確認與測試需求一致。

---

## 版本資訊

**文件版本**：1.0
**更新日期**：2025-01-15
**適用系統**：TXT to Excel 自動轉換工具

---

## 技術支援

如有任何問題或建議，請聯繫：
- **專案維護**：GitHub Repository
- **問題回報**：提交 Issue

---

**本文件由自動化測試報告轉換系統產生**
