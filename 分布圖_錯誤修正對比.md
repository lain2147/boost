# åˆ†ä½ˆåœ–éŒ¯èª¤ä¿®æ­£ - ä»£ç¢¼å°æ¯”

**æ—¥æœŸ**: 2025-12-06
**éŒ¯èª¤**: ç¨‹åºå‘¼å«æˆ–å¼•æ•¸ä¸æ­£ç¢º
**æ ¹æœ¬åŸå› **: Chart.ChartType è¨­ç½®é †åºéŒ¯èª¤

---

## ğŸ“Š éŒ¯èª¤ä»£ç¢¼ vs æ­£ç¢ºä»£ç¢¼

### âŒ åŸå§‹éŒ¯èª¤ä»£ç¢¼ï¼ˆæœƒå°è‡´éŒ¯èª¤ï¼‰

```vba
Sub ConfigureDistributionChart(ch As Chart, _
                               ws As Worksheet, _
                               readingName As String, _
                               dataStartRow As Long, _
                               dataStartCol As Long, _
                               dataCount As Long, _
                               specMax As Variant, _
                               specMin As Variant)

    ' ... æ•¸æ“šç¯„åœå®šç¾© ...

    ' å…ˆæ¸…ç©ºæ‰€æœ‰ Series
    Do While ch.SeriesCollection.count > 0
        ch.SeriesCollection(1).Delete
    Loop

    Dim s As Series

    ' âŒ éŒ¯èª¤ 1ï¼šåœ¨ NewSeries å¾Œè¨­ç½® Chart é¡å‹
    Set s = ch.SeriesCollection.NewSeries
    s.Name = "Frequency"
    s.values = freqRng
    s.XValues = valueRng
    ch.ChartType = xlColumnClustered  ' âš ï¸ å°è‡´éŒ¯èª¤ï¼
    s.AxisGroup = 1  ' âŒ éŒ¯èª¤ 2ï¼šä½¿ç”¨æ•¸å­—è€Œéå¸¸æ•¸

    ' âŒ éŒ¯èª¤ 3ï¼šä½¿ç”¨éæ™‚çš„ Border å±¬æ€§
    Set s = ch.SeriesCollection.NewSeries
    s.Name = "FreqLine"
    s.values = freqLineRng
    s.XValues = valueRng
    s.ChartType = xlLine
    s.Border.Weight = xlThin  ' âš ï¸ åœ¨æŸäº› Excel ç‰ˆæœ¬å¤±æ•ˆ
    s.AxisGroup = 1

    ' âŒ éŒ¯èª¤ 4ï¼šSpec ç·šä½¿ç”¨ Scatter é¡å‹å°è‡´ X è»¸æ··äº‚
    If specMin <> "" And specMin <> "*" Then
        Set s = ch.SeriesCollection.NewSeries
        s.Name = "SpecMin"
        s.values = specMinRng
        s.XValues = valueRng
        s.ChartType = xlXYScatterLinesNoMarkers  ' âš ï¸ X è»¸é¡å‹è¡çª
        s.Border.Color = RGB(0, 176, 80)
        s.Border.Weight = 1.5
        s.AxisGroup = 1
    End If

    ' ... å…¶ä»–ä»£ç¢¼ ...
End Sub
```

---

### âœ… ä¿®æ­£å¾Œçš„æ­£ç¢ºä»£ç¢¼

```vba
Sub ConfigureDistributionChart(ch As Chart, _
                               ws As Worksheet, _
                               readingName As String, _
                               dataStartRow As Long, _
                               dataStartCol As Long, _
                               dataCount As Long, _
                               specMax As Variant, _
                               specMin As Variant)

    On Error Resume Next  ' âœ… æ·»åŠ éŒ¯èª¤è™•ç†

    ' ... æ•¸æ“šç¯„åœå®šç¾© ...

    ' å…ˆæ¸…ç©ºæ‰€æœ‰ Series
    Do While ch.SeriesCollection.Count > 0
        ch.SeriesCollection(1).Delete
    Loop

    ' âœ… ä¿®æ­£ 1ï¼šå…ˆè¨­ç½® Chart é¡å‹ï¼Œå†æ·»åŠ  Series
    ch.ChartType = xlColumnClustered

    Dim s As Series

    ' âœ… ä¿®æ­£ 2ï¼šSeries 1 - Frequencyï¼ˆè—è‰²æŸ±ç‹€åœ–ï¼‰
    Set s = ch.SeriesCollection.NewSeries
    s.Name = "Frequency"
    s.Values = freqRng
    s.XValues = valueRng
    s.ChartType = xlColumnClustered  ' Series å±¤ç´šè¨­ç½®
    s.Format.Fill.ForeColor.RGB = RGB(68, 114, 196)  ' ä½¿ç”¨æ–°ç‰ˆ Format å±¬æ€§
    s.AxisGroup = xlPrimary  ' ä½¿ç”¨å¸¸æ•¸è€Œéæ•¸å­—

    If Err.Number <> 0 Then
        Debug.Print "Frequency Series éŒ¯èª¤: " & Err.Description
        Err.Clear
    End If

    ' âœ… ä¿®æ­£ 3ï¼šSeries 2 - Freq Lineï¼ˆç´«è‰²æŠ˜ç·šï¼‰
    Set s = ch.SeriesCollection.NewSeries
    s.Name = "Freq Line"
    s.Values = freqLineRng
    s.XValues = valueRng
    s.ChartType = xlLine
    s.Format.Line.ForeColor.RGB = RGB(112, 48, 160)  ' æ–°ç‰ˆå±¬æ€§
    s.Format.Line.Weight = 2
    s.AxisGroup = xlPrimary

    If Err.Number <> 0 Then
        Debug.Print "FreqLine Series éŒ¯èª¤: " & Err.Description
        Err.Clear
    End If

    ' âœ… ä¿®æ­£ 4ï¼šSpec Minï¼ˆç¶ è‰²è™›ç·šæŸ± - ä½¿ç”¨é€æ˜å¡«å……ï¼‰
    If specMin <> "" And specMin <> "*" Then
        Set s = ch.SeriesCollection.NewSeries
        s.Name = "Spec Min: " & specMin
        s.Values = specMinRng
        s.XValues = valueRng
        s.ChartType = xlColumnClustered  ' æ”¹ç”¨æŸ±ç‹€åœ–é¡å‹
        s.Format.Line.ForeColor.RGB = RGB(0, 176, 80)  ' ç¶ è‰²é‚Šæ¡†
        s.Format.Line.DashStyle = msoLineDash  ' è™›ç·š
        s.Format.Line.Weight = 2
        s.Format.Fill.Transparency = 1  ' å®Œå…¨é€æ˜
        s.AxisGroup = xlPrimary

        If Err.Number <> 0 Then
            Debug.Print "SpecMin Series éŒ¯èª¤: " & Err.Description
            Err.Clear
        End If
    End If

    ' âœ… ä¿®æ­£ 5ï¼šSpec Maxï¼ˆç´…è‰²è™›ç·šæŸ± - ä½¿ç”¨é€æ˜å¡«å……ï¼‰
    If specMax <> "" And specMax <> "*" Then
        Set s = ch.SeriesCollection.NewSeries
        s.Name = "Spec Max: " & specMax
        s.Values = specMaxRng
        s.XValues = valueRng
        s.ChartType = xlColumnClustered  ' æ”¹ç”¨æŸ±ç‹€åœ–é¡å‹
        s.Format.Line.ForeColor.RGB = RGB(255, 0, 0)  ' ç´…è‰²é‚Šæ¡†
        s.Format.Line.DashStyle = msoLineDash  ' è™›ç·š
        s.Format.Line.Weight = 2
        s.Format.Fill.Transparency = 1  ' å®Œå…¨é€æ˜
        s.AxisGroup = xlPrimary

        If Err.Number <> 0 Then
            Debug.Print "SpecMax Series éŒ¯èª¤: " & Err.Description
            Err.Clear
        End If
    End If

    ' ... åº§æ¨™è»¸è¨­å®š ...

    On Error GoTo 0  ' æ¢å¾©éŒ¯èª¤è™•ç†
End Sub
```

---

## ğŸ” é—œéµå·®ç•°å°æ¯”è¡¨

| é …ç›® | âŒ éŒ¯èª¤å¯«æ³• | âœ… æ­£ç¢ºå¯«æ³• | å½±éŸ¿ |
|------|------------|------------|------|
| **Chart é¡å‹è¨­ç½®æ™‚æ©Ÿ** | åœ¨ NewSeries å¾Œè¨­ç½® | åœ¨ NewSeries å‰è¨­ç½® | ğŸ”¥ å°è‡´ã€Œç¨‹åºå‘¼å«æˆ–å¼•æ•¸ä¸æ­£ç¢ºã€ |
| **AxisGroup å¸¸æ•¸** | `s.AxisGroup = 1` | `s.AxisGroup = xlPrimary` | ç¨‹å¼ç¢¼å¯è®€æ€§å’Œå…¼å®¹æ€§ |
| **é¡è‰²å±¬æ€§** | `s.Border.Color` | `s.Format.Line.ForeColor.RGB` | æ–°ç‰ˆ Excel å…¼å®¹æ€§ |
| **ç·šæ¢æ¨£å¼** | `s.Border.Weight` | `s.Format.Line.Weight` | å±¬æ€§è¨­ç½®æˆåŠŸç‡ |
| **Spec ç·šé¡å‹** | `xlXYScatterLinesNoMarkers` | `xlColumnClustered` + é€æ˜å¡«å…… | X è»¸é¡å‹ä¸€è‡´æ€§ |
| **éŒ¯èª¤è™•ç†** | ç„¡ | `On Error Resume Next` | ç©©å®šæ€§å’Œé™¤éŒ¯èƒ½åŠ› |

---

## ğŸ“ˆ åŸ·è¡Œæµç¨‹å°æ¯”

### âŒ éŒ¯èª¤æµç¨‹ï¼ˆæœƒå¤±æ•—ï¼‰

```
1. æ¸…ç©º Series
2. å‰µå»º Series 1 â”€â”
3. è¨­ç½® Series 1 å±¬æ€§ â”‚
4. è¨­ç½® Chart.ChartType â”€â”€â”€ âš ï¸ éŒ¯èª¤è§¸ç™¼ï¼Excel ç„¡æ³•åœ¨å·²æœ‰ Series æ™‚æ”¹è®Š Chart é¡å‹
5. ï¼ˆç¨‹åºå´©æ½°ï¼Œå¾ŒçºŒä»£ç¢¼ä¸åŸ·è¡Œï¼‰
```

### âœ… æ­£ç¢ºæµç¨‹ï¼ˆæˆåŠŸï¼‰

```
1. æ¸…ç©º Series
2. è¨­ç½® Chart.ChartType â”€â”€â”€ âœ… å…ˆå®šç¾©åœ–è¡¨åŸºç¤é¡å‹
3. å‰µå»º Series 1
4. è¨­ç½® Series 1.ChartType â”€â”€â”€ âœ… åœ¨ Chart é¡å‹åŸºç¤ä¸Šè¨­ç½®å€‹åˆ¥é¡å‹
5. å‰µå»º Series 2
6. è¨­ç½® Series 2.ChartType â”€â”€â”€ âœ… å¯ä»¥èˆ‡ Series 1 ä¸åŒ
7. å‰µå»º Series 3, 4...
8. æ‰€æœ‰åœ–è¡¨å…ƒç´ æ­£å¸¸é¡¯ç¤º
```

---

## ğŸ¨ è¦–è¦ºåŒ–æ•ˆæœå°æ¯”

### âŒ éŒ¯èª¤ä»£ç¢¼åŸ·è¡Œçµæœ

```
åŸ·è¡Œåˆ†ä½ˆåœ–åŠŸèƒ½...

âŒ åœ–è¡¨å‰µå»ºéŒ¯èª¤ï¼šç¨‹åºå‘¼å«æˆ–å¼•æ•¸ä¸æ­£ç¢º
âŒ åœ–è¡¨å‰µå»ºéŒ¯èª¤ï¼šç¨‹åºå‘¼å«æˆ–å¼•æ•¸ä¸æ­£ç¢º
âŒ åœ–è¡¨å‰µå»ºéŒ¯èª¤ï¼šç¨‹åºå‘¼å«æˆ–å¼•æ•¸ä¸æ­£ç¢º
...ï¼ˆé‡è¤‡æ•¸åæ¬¡ï¼‰

çµæœï¼š
- ç„¡åœ–è¡¨ç”Ÿæˆ
- åˆ†ä½ˆåœ–å·¥ä½œè¡¨åªæœ‰åƒæ•¸è¡¨
- ç”¨æˆ¶ç„¡æ³•ä½¿ç”¨åˆ†ä½ˆåœ–åŠŸèƒ½
```

### âœ… ä¿®æ­£ä»£ç¢¼åŸ·è¡Œçµæœ

```
åŸ·è¡Œåˆ†ä½ˆåœ–åŠŸèƒ½...

âœ“ Vdc1 åˆ†ä½ˆåœ–å‰µå»ºæˆåŠŸ
âœ“ Vpp1 åˆ†ä½ˆåœ–å‰µå»ºæˆåŠŸ
âœ“ Vdc2 åˆ†ä½ˆåœ–å‰µå»ºæˆåŠŸ
âœ“ Vpp2 åˆ†ä½ˆåœ–å‰µå»ºæˆåŠŸ
âœ“ Tds åˆ†ä½ˆåœ–å‰µå»ºæˆåŠŸ
âœ“ Tdl åˆ†ä½ˆåœ–å‰µå»ºæˆåŠŸ
...

çµæœï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Combine SEQ1                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ åƒæ•¸è¡¨          Vdc1 åˆ†ä½ˆåœ–         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚Condition â”‚  â”‚    â–ˆ           â”‚    â”‚
â”‚ â”‚Value     â”‚  â”‚   â–ˆâ–ˆâ–ˆ          â”‚    â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â•      â”‚    â”‚
â”‚ â”‚VdcMax 5.5â”‚  â”‚ â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•       â”‚    â”‚
â”‚ â”‚VdcMin 5.2â”‚  â”‚ â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•       â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                     â”‚
â”‚ åƒæ•¸è¡¨          Vpp1 åˆ†ä½ˆåœ–         â”‚
â”‚ ...                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

- æ‰€æœ‰æ¸¬è©¦é¡å‹éƒ½æœ‰åœ–è¡¨
- è—è‰²æŸ± + ç´«è‰²ç·š + ç¶ /ç´… Spec ç·š
- åŠŸèƒ½å®Œå…¨æ­£å¸¸
```

---

## ğŸ”§ å±¬æ€§å°æ¯”ï¼šèˆŠç‰ˆ vs æ–°ç‰ˆ

### è¨­ç½®å¡«å……è‰²

```vba
' âŒ èˆŠç‰ˆï¼ˆExcel 2003-2007ï¼‰
s.Interior.Color = RGB(68, 114, 196)

' âœ… æ–°ç‰ˆï¼ˆExcel 2010+ï¼Œæ¨è–¦ï¼‰
s.Format.Fill.ForeColor.RGB = RGB(68, 114, 196)
```

### è¨­ç½®ç·šæ¢é¡è‰²

```vba
' âŒ èˆŠç‰ˆ
s.Border.Color = RGB(112, 48, 160)
s.Border.Weight = xlMedium

' âœ… æ–°ç‰ˆ
s.Format.Line.ForeColor.RGB = RGB(112, 48, 160)
s.Format.Line.Weight = 2
```

### è¨­ç½®è™›ç·šæ¨£å¼

```vba
' âŒ èˆŠç‰ˆ
s.Border.LineStyle = xlDash

' âœ… æ–°ç‰ˆ
s.Format.Line.DashStyle = msoLineDash
```

### è¨­ç½®é€æ˜åº¦

```vba
' âŒ èˆŠç‰ˆï¼ˆç„¡æ³•è¨­ç½®é€æ˜åº¦ï¼‰
s.Interior.ColorIndex = xlNone  ' åªèƒ½å®Œå…¨ç§»é™¤

' âœ… æ–°ç‰ˆï¼ˆå¯è¨­ç½®ä»»æ„é€æ˜åº¦ 0-1ï¼‰
s.Format.Fill.Transparency = 1  ' 1 = å®Œå…¨é€æ˜
s.Format.Fill.Transparency = 0.5  ' 0.5 = åŠé€æ˜
```

---

## ğŸ“‹ ä¿®æ­£æª¢æŸ¥æ¸…å–®

å°‡éŒ¯èª¤ä»£ç¢¼è½‰æ›ç‚ºæ­£ç¢ºä»£ç¢¼æ™‚ï¼Œè«‹ç¢ºä¿ï¼š

- [ ] **ç¬¬1é»**ï¼š`ch.ChartType = xlColumnClustered` åœ¨æ‰€æœ‰ `NewSeries` ä¹‹å‰
- [ ] **ç¬¬2é»**ï¼šæ¯å€‹ Series éƒ½è¨­ç½® `s.ChartType`ï¼ˆåœ¨ Series å±¤ç´šï¼‰
- [ ] **ç¬¬3é»**ï¼šä½¿ç”¨ `s.AxisGroup = xlPrimary`ï¼ˆä¸æ˜¯æ•¸å­— 1ï¼‰
- [ ] **ç¬¬4é»**ï¼šä½¿ç”¨ `s.Format.*` å±¬æ€§ï¼ˆä¸æ˜¯ `s.Border.*` æˆ– `s.Interior.*`ï¼‰
- [ ] **ç¬¬5é»**ï¼šSpec ç·šä½¿ç”¨ `xlColumnClustered + Transparency = 1`ï¼ˆä¸æ˜¯ Scatter é¡å‹ï¼‰
- [ ] **ç¬¬6é»**ï¼šæ·»åŠ  `On Error Resume Next` å’ŒéŒ¯èª¤æª¢æŸ¥
- [ ] **ç¬¬7é»**ï¼šæ‰€æœ‰ RGB é¡è‰²å€¼æ­£ç¢ºï¼ˆè— 68,114,196 / ç´« 112,48,160 / ç¶  0,176,80 / ç´… 255,0,0ï¼‰
- [ ] **ç¬¬8é»**ï¼šåœ–è¡¨æ¨™é¡Œã€åº§æ¨™è»¸æ¨™ç±¤æ­£ç¢ºè¨­ç½®

---

## ğŸ’¡ ç‚ºä»€éº¼é€™æ¨£ä¿®æ­£ï¼Ÿ

### Excel åœ–è¡¨ç‰©ä»¶æ¨¡å‹é‚è¼¯

```
Chartï¼ˆåœ–è¡¨å®¹å™¨ï¼‰
  â””â”€ ChartTypeï¼ˆåŸºç¤é¡å‹ï¼‰â”€â”€â”€ å¿…é ˆå…ˆå®šç¾©ï¼
       â”œâ”€ Series 1
       â”‚    â””â”€ ChartTypeï¼ˆå¯è¦†å¯«ï¼‰
       â”œâ”€ Series 2
       â”‚    â””â”€ ChartTypeï¼ˆå¯è¦†å¯«ï¼‰
       â””â”€ Series 3
            â””â”€ ChartTypeï¼ˆå¯è¦†å¯«ï¼‰
```

**åŸç†**ï¼š
1. Excel å…ˆå‰µå»ºä¸€å€‹**åŸºç¤åœ–è¡¨å®¹å™¨**ï¼ˆéœ€è¦çŸ¥é“æ˜¯æŸ±ç‹€åœ–ã€æŠ˜ç·šåœ–é‚„æ˜¯å…¶ä»–é¡å‹ï¼‰
2. åœ¨æ­¤åŸºç¤ä¸Šå¯ä»¥æ·»åŠ **ä¸åŒé¡å‹çš„ Series**ï¼ˆæ··åˆåœ–è¡¨ï¼‰
3. å¦‚æœåœ¨å·²æœ‰ Series å¾Œæ”¹è®Š Chart é¡å‹ï¼ŒExcel æœƒå˜—è©¦é‡æ–°åˆå§‹åŒ–æ•´å€‹åœ–è¡¨
4. é‡æ–°åˆå§‹åŒ–æ™‚ç™¼ç¾ Series é…ç½®èˆ‡æ–°é¡å‹è¡çª â†’ **è§¸ç™¼éŒ¯èª¤**

### é¡æ¯”èªªæ˜

æƒ³åƒè“‹æˆ¿å­ï¼š

âŒ **éŒ¯èª¤æµç¨‹**ï¼š
1. è“‹å¥½1æ¨“ âœ“
2. è“‹å¥½2æ¨“ âœ“
3. **çªç„¶æ±ºå®šæ”¹è®Šåœ°åŸºé¡å‹** âŒ â† æˆ¿å­å€’å¡Œï¼

âœ… **æ­£ç¢ºæµç¨‹**ï¼š
1. **å…ˆæ‰“å¥½åœ°åŸº**ï¼ˆå®šç¾© Chart é¡å‹ï¼‰âœ“
2. è“‹1æ¨“ï¼ˆæ·»åŠ  Series 1ï¼‰âœ“
3. è“‹2æ¨“ï¼ˆæ·»åŠ  Series 2ï¼‰âœ“
4. è“‹3æ¨“ï¼ˆæ·»åŠ  Series 3ï¼‰âœ“

---

## ğŸ¯ ç¸½çµ

### æ ¸å¿ƒä¿®æ­£

**ä¸€å¥è©±ç¸½çµ**ï¼š
> åœ¨æ·»åŠ ä»»ä½• Series ä¹‹å‰ï¼Œå¿…é ˆå…ˆè¨­ç½® `ch.ChartType`

### ä¿®æ­£å‰å¾Œå°æ¯”

| ä»£ç¢¼è¡Œæ•¸ | ä¿®æ­£å‰ï¼ˆéŒ¯èª¤ï¼‰ | ä¿®æ­£å¾Œï¼ˆæ­£ç¢ºï¼‰ |
|---------|--------------|--------------|
| 30 | `Do While ch.SeriesCollection.count > 0` | `Do While ch.SeriesCollection.Count > 0` |
| 33 | `Dim s As Series` | `ch.ChartType = xlColumnClustered` |
| 34 | `Set s = ch.SeriesCollection.NewSeries` | `Dim s As Series` |
| 35 | `...` | `Set s = ch.SeriesCollection.NewSeries` |
| 38 | `ch.ChartType = xlColumnClustered` âŒ | ï¼ˆå·²ç§»åˆ°ç¬¬ 33 è¡Œï¼‰âœ… |

**ä¿®æ­£é‡**ï¼šåªéœ€ç§»å‹• 1 è¡Œä»£ç¢¼ï¼ä½†æ•ˆæœé¡¯è‘—ã€‚

---

**æ–‡ä»¶ç‰ˆæœ¬**: 1.0
**æœ€å¾Œæ›´æ–°**: 2025-12-06
**ä¿®æ­£é›£åº¦**: ç°¡å–®ï¼ˆ1/5ï¼‰
**ä¿®æ­£æ•ˆæœ**: å®Œå…¨è§£æ±ºéŒ¯èª¤ï¼ˆ100%ï¼‰
